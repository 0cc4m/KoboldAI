<script>
	function show_setting_menu(span) {
		menu = span.textContent.toLowerCase()
		for (item of document.getElementsByClassName("setting_menu_button")) {
			document.getElementById("setting_menu_"+item.textContent.toLowerCase()).classList.add("hidden");
			item.classList.remove("selected");
		}
		span.classList.add("selected");
		document.getElementById("setting_menu_"+menu).classList.remove("hidden");
	}
</script>
<style>
	#Model_Info {
		width: 100%;
	}
	#Story_Info {
		width: 100%;
	}
	#save_story[story_gamesaved="true"] {
		text: var(--disabled_button_text);
		background-color: var(--disabled_button_background_color);
		border-color: var(--disabled_button_border_color);
		filter: brightness(85%);
	}
	
</style>
<!-- top menu bar-->
<div class="menu_pin_area"></div>
<div class="tabrow">
	<span class="setting_menu_button selected" onclick="show_setting_menu(this);">Model</span>
	<span class="setting_menu_button" onclick="show_setting_menu(this);">Story</span>
	<span class="setting_menu_button" onclick="show_setting_menu(this);">User</span>
	<span class="setting_menu_button" onclick="show_setting_menu(this);">UI</span>
	<span style="float: right;margin-right: 30px;" onclick="window.open('https://github.com/KoboldAI/KoboldAI-Client/wiki');">Help</span>
</div>
<div class="flyout_menu_contents">

	<div id="setting_menu_model" class="settings_category_area">
		<div id="Model_Info">
			<div>
				Running Model: <span class="var_sync_model_model">ReadOnly</span>
				<select id=presets class="var_sync_model_selected_preset settings_select presets" onchange='sync_to_server(this)'><option>Preset</option></select>
			</div>
			<div><button class="btn action_button" onclick="socket.emit('load_model_button', {});">Load Model</button></div>
		</div>
		<div class="setting_tile_area">
		{% with menu='Model' %}
			{% include 'settings item.html' %}
		{% endwith %}
		</div>
	</div>
	<div id="setting_menu_story" class="hidden settings_category_area">
		<div id="Story_Info">
			<div><b>Story Name: </b><span class="var_sync_story_story_name" contenteditable=true onblur="sync_to_server(this);"></span></div>
			<div>
				<button id="new_story" class="btn action_button" onclick="new_story();">New Story</button>
				<button id="load_story" class="btn action_button" onclick="socket.emit('load_story_list', '');">Load Story</button>
				<button id="save_story" class="btn action_button var_sync_alt_story_gamesaved" onclick='socket.emit("save_story", null, (response) => {save_as_story(response);});'>Save Story</button>
				<!---<button id="download_story" class="btn action_button" onclick="document.getElementById('download_iframe').src = 'json';">Download Story</button>--->
				<a class='cursor' onclick="document.getElementById('download_iframe').src = 'json';">Download Story</a>
			</div>
		</div>
		<div class="setting_tile_area">
		{% with menu='Story' %}
			{% include 'settings item.html' %}
		{% endwith %}
		</div>
		<h4>
			<span id="bias_open" class="oi" data-glyph="chevron-bottom" onclick='this.classList.add("hidden"); 
																				 document.getElementById("bias_close").classList.remove("hidden"); 
																				 document.getElementById("biasing").classList.add("hidden");'> Biasing:</span>
			<span id="bias_close" class="oi hidden" data-glyph="chevron-right" onclick='this.classList.add("hidden"); 
																				 document.getElementById("bias_open").classList.remove("hidden"); 
																				 document.getElementById("biasing").classList.remove("hidden");'> Biasing:</span>
		</h4>
		<div id="biasing">
			<div class="bias_header">
				<div class="bias_header_phrase">Phrase</div>
				<div class="bias_header_score">Score</div>
				<div class="bias_header_comp_threshold">Completion Threshold</div>
			</div>
		</div>
	</div>
	<div id="setting_menu_user" class="hidden settings_category_area">
		<div class="setting_tile_area">
		{% with menu='User' %}
			{% include 'settings item.html' %}
		{% endwith %}
		</div>
	</div>
	<div id="setting_menu_ui" class="hidden settings_category_area">
		<div class="setting_tile_area">
			<div class="setting_container">
				<span class="setting_label">
					Maximize Game Text Space: 
					<span class="helpicon">
						?
						<span class="helptext">
							When enabled and both menus are un-pinned, the game screen will take up all avaialable space. When disabled, the game screen will be centered.
						</span>
					</span>
				</span>
				<span class="setting_item">
					<input type=checkbox id="preserve_game_space_setting" data-size=mini data-onstyle=success data-toggle=toggle onchange="preserve_game_space(this.checked)"/>
				</span>
				<!---Slider Labels--->
				<span class="setting_minlabel"><span style="top: -4px; position: relative;"></span></span>
				<span class="setting_maxlabel"><span style="top: -4px; position: relative;"></span></span>
			</div>
			<div class="setting_container">
				<span class="setting_label">
					Keep options on Right: 
					<span class="helpicon">
						?
						<span class="helptext">
							When enabled and only the story menu is pinned, the generated story options will be shown on the right instead of the left of the game text.
						</span>
					</span>
				</span>
				<span class="setting_item">
					<input type=checkbox id="options_on_right" data-size=mini data-onstyle=success data-toggle=toggle onchange="options_on_right(this.checked)"/>
				</span>
				<!---Slider Labels--->
				<span class="setting_minlabel"><span style="top: -4px; position: relative;"></span></span>
				<span class="setting_maxlabel"><span style="top: -4px; position: relative;"></span></span>
			</div>
		</div>
	</div>
</div>